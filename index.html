<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta                                       charset="UTF-8">
        <meta   http-equiv="Permissions-Policy"     content="interest-cohort=()">
        <meta   name="viewport"                     content="width=device-width, initial-scale=1.0">
        <meta   name="author"                       content="Plutonny">
        <meta   name="keywords"                     content="КСК-11, кск, кск 11, акт кск, акт">
        <meta   name="description"                  content="Главная, КСК-11">
        <meta   name="theme-color" id="theme-color" content="#202020">

        <title  id="csc11-title-of-page"            >Главная, КСК-11</title>

        <link   rel="preconnect"                    href="https://fonts.googleapis.com">
        <link   rel="preconnect"                    href="https://fonts.gstatic.com" crossorigin>
        <link   rel="stylesheet"                    href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap">
        <link   rel="stylesheet"                    href="https://fonts.googleapis.com/css2?family=Nunito:wght@600&display=swap">
        <script type="text/javascript"              src="https://bebrarium.plutonny.ru/solar.js"></script>
        <script type="text/javascript"              src="https://bebrarium.plutonny.ru/luxon.js"></script>
        <script type="text/javascript"              src="//cdn.jsdelivr.net/npm/eruda"></script>
        
        <link   rel="icon"                          href="/college-beta/csc11-favicon.png">
        <link   rel="manifest"                      href="/college-beta/manifest.json">
        <link   rel="preload prefetch stylesheet"   href="/assets/beta/main.css" as="style">
        
        <script> var thisPageBuild = 82; </script>
        
        <style  id="root-colors-theme">#thMoon, #thSun { display: none; }</style>
        
        <script type="text/javascript"              src="/assets/beta/plutonny.js"></script>
        <script type="text/javascript"              src="/assets/beta/preload.js"></script>
        <script type="text/javascript"              src="/assets/beta/frames.js"></script>
        <script type="text/javascript"              src="/assets/beta/main.js"></script>
        <script type="text/javascript"              src="/assets/beta/timetable.js"></script>
    </head>
    <body>
        <div class="modal" id="modal"></div>
        <div class="header" id="header"></div>
        <div class="navbar" id="navbar"><script>frames.navbar('home')</script></div>
        <div class="greeting" id="greeting"></div>
        <div class="content" id="content">
            <style>
                .content { margin: 24px; padding-bottom: 80px; }
                p, a, b, h1, h2, h3, h4, h5, h6, button { font-family: 'Montserrat'; }
            </style>
            <h1 style="text-align: center; padding: 42px;">Ошибка!</h1>
            <p style="text-align: center;">Что случилось? Эта ошибка означает, что страница никак не смогла загрузиться.</p>
            <p style="padding-top: 36px;">Что делать? Можете написать разработчику.</p>
            <div style="display: flex; flex-direction: row; flex-wrap: nowrap; align-items: center; border-radius: 16px; padding: 8px; margin-top: 24px; background-color: #ff000050; fill: currentColor;">
                <p style="margin: 2px 4px; font-size: 15px;">Одна из вероятных проблем: не переустановленное приложение. Если Вы его переустановили и вновь увидели эту ошибку, то переустановите еще раз, но перед этим еще очистите кэш браузера.</p>
                <div style="width: 48px; padding: 0px 4px;"><svg style="color: #bd0000a8;" xmlns="http://www.w3.org/2000/svg" height="48" width="48"><path d="M24.2 34.4Q24.95 34.4 25.475 33.875Q26 33.35 26 32.55V23.75Q26 23.05 25.45 22.525Q24.9 22 24.2 22Q23.4 22 22.875 22.525Q22.35 23.05 22.35 23.8V32.6Q22.35 33.35 22.9 33.875Q23.45 34.4 24.2 34.4ZM24 17.9Q24.8 17.9 25.35 17.375Q25.9 16.85 25.9 16.05Q25.9 15.2 25.35 14.65Q24.8 14.1 24 14.1Q23.15 14.1 22.625 14.65Q22.1 15.2 22.1 16.05Q22.1 16.85 22.65 17.375Q23.2 17.9 24 17.9ZM24 44.8Q19.6 44.8 15.8 43.2Q12 41.6 9.2 38.8Q6.4 36 4.8 32.2Q3.2 28.4 3.2 24Q3.2 19.6 4.8 15.8Q6.4 12 9.2 9.2Q12 6.4 15.8 4.8Q19.6 3.2 24 3.2Q28.4 3.2 32.2 4.8Q36 6.4 38.8 9.2Q41.6 12 43.2 15.8Q44.8 19.6 44.8 24Q44.8 28.4 43.2 32.2Q41.6 36 38.8 38.8Q36 41.6 32.2 43.2Q28.4 44.8 24 44.8Z"/></svg></div>
            </div>
            <p>Для опытных пользователей: можно полностью сбросить настройки, это поможет, если проблема со стороны браузера (а проблема скорее всего именно со стороны браузера)</p>
            <div style="display: flex; align-items: center; justify-content: center; flex-wrap: wrap; margin-top: 12px; margin-bottom: 64px;">
                <script>
                    function DELETEALL() {
                        try {
                            localStorage.clear()
                            sessionStorage.clear()
                            caches.delete('csc11-byPlutonny')
                            caches.delete('plutonny-college')
                            document.getElementById('content').innerHTML = `
                            <style>
                                .content { margin: 24px; padding-bottom: 80px; }
                                p, a, b, h1, h2, h3, h4, h5, h6, button { font-family: 'Montserrat'; }
                            </style>
                            <h1 style="text-align: center; padding: 42px;">Успешно!</h1>
                            <p style="text-align: center;">Теперь можно перезагрузить страницу.</p>
                            `
                        } catch (e) {
                            document.getElementById('content').innerHTML = `
                            <style>
                                .content { margin: 24px; padding-bottom: 80px; }
                                p, a, b, h1, h2, h3, h4, h5, h6, button { font-family: 'Montserrat'; }
                            </style>
                            <h1 style="text-align: center; padding: 42px;">Не успешно!</h1>
                            <p style="text-align: center;">Прозошла ошибка при сбросе: ${e}</p>
                            `
                        }
                        
                    }
                </script>
                <button style="height: 48px; width: 256px; margin: 8px; border: none; border-radius: 100px; cursor: pointer;" onclick="DELETEALL()">Сбросить настройки</button>
            </div>
        </div>
        
        <script>
            if (REQUEST.timetable != undefined) {
                var inj = ''
                plutonny.output('csc11-title-of-page', 'Расписание, КСК-11')
                if (REQUEST.timetable == 'week') {
                    frames.header(`Расписание на неделю`, [false, true], true)
                    plutonny.output('greeting', `
                    <style>
                        .content { padding: 12px 24px 73px 24px !important; background-color: var(--secondary-bg-color); border-top-left-radius: 24px; border-top-right-radius: 24px; min-height: calc(100vh - 88px); }
                        .greeting { margin: 8px 0; width: 100%; display: flex; flex-direction: row; flex-wrap: nowrap; justify-content: space-evenly; }
                    </style>
                    <style id="timetableCSS"></style>
                    <button class="timetableWorkButton1" style="font-family: 'Montserrat'; width: 11%; height: 56px; border: none; border-radius: 16px;" onclick="TIMETABLE.pair.weekChanger(1)">ПН</button>
                    <button class="timetableWorkButton2" style="font-family: 'Montserrat'; width: 11%; height: 56px; border: none; border-radius: 16px;" onclick="TIMETABLE.pair.weekChanger(2)">ВТ</button>
                    <button class="timetableWorkButton3" style="font-family: 'Montserrat'; width: 11%; height: 56px; border: none; border-radius: 16px;" onclick="TIMETABLE.pair.weekChanger(3)">СР</button>
                    <button class="timetableWorkButton4" style="font-family: 'Montserrat'; width: 11%; height: 56px; border: none; border-radius: 16px;" onclick="TIMETABLE.pair.weekChanger(4)">ЧТ</button>
                    <button class="timetableWorkButton5" style="font-family: 'Montserrat'; width: 11%; height: 56px; border: none; border-radius: 16px;" onclick="TIMETABLE.pair.weekChanger(5)">ПТ</button>
                    <button class="timetableWorkButton6" style="font-family: 'Montserrat'; width: 11%; height: 56px; border: none; border-radius: 16px;" onclick="TIMETABLE.pair.weekChanger(6)">СБ</button>
                    `)
                    inj += `
                    <h2 id="timetableWeekName" style="margin-top: 12px;"></h2>
                    ${TIMETABLE.pair.get.HTML.week()}
                    <div style="display: flex; justify-content: center;">
                        <button style="margin: 24px 0px; font-family: 'Montserrat' !important; cursor: pointer; border: none; border-radius: 16px; height: 42px; font-size: 16px; width: 100%;" onclick="location.assign('${link({type: 'HTML', file: '?timetable=alerts'})}')">Расписание звонков</button>
                    </div>
                    `
                } else if (REQUEST.timetable == 'alerts') {
                    frames.header(`Расписание звонков`, [false, true], false)
                    inj += `
                    <style>
                        .content { background-color: var(--secondary-bg-color); border-top-left-radius: 24px; border-top-right-radius: 24px; padding: 24px 24px 73px 24px; min-height: calc(100vh - 100px); }
                        td.alertsTableTD { border: 1px solid #707070; height: 43px; padding: 0px 8px; font-family: 'Montserrat'; }
                        td.alertsTableTDF { border: 1px solid #707070; height: 43px; padding: 0px 8px; font-family: 'Montserrat'; width: 24px; }
                        table { width: 256px; }
                    </style>
                        
                    <h2 style="text-align: left; margin: 0 0 12px 0;">Стандартное расписание:</h2>
                    <table style="border: 1px solid #707070; border-radius: 18px; text-align: center; border-collapse: separate; border-spacing: 0px; margin: auto; background-color: var(--root-navbar-bg-color);">
                        <tr class="btl btr">
                            <td class="alertsTableTDF btl">1</td>
                            <td class="alertsTableTD">8:30-9:15</td>
                            <td class="alertsTableTD btr">9:20-10:05</td>
                        </tr>
                        <tr>
                            <td class="alertsTableTDF">2</td>
                            <td class="alertsTableTD">10:15-11:00</td>
                            <td class="alertsTableTD">11:05-11:50</td>
                        </tr>
                        <tr>
                            <td class="alertsTableTDF">БП</td>
                            <td class="alertsTableTD" colspan="2">11:50-12:35</td>
                        </tr>
                        <tr>
                            <td class="alertsTableTDF">3</td>
                            <td class="alertsTableTD">12:35-13:20</td>
                            <td class="alertsTableTD">13:25-14:10</td>
                        </tr>
                        <tr>
                            <td class="alertsTableTDF">4</td>
                            <td class="alertsTableTD">14:20-15:05</td>
                            <td class="alertsTableTD">15:10-15:55</td>
                        </tr>
                        <tr class="bbl bbr">
                            <td class="alertsTableTDF bbl">5</td>
                            <td class="alertsTableTD">16:05-16:50</td>
                            <td class="alertsTableTD bbr">16:55-17:40</td>
                        </tr>
                    </table>
                    <h2 style="text-align: left; margin: 12px 0;">Праздничное расписание:</h2>
                    <table style="border: 1px solid #707070; border-radius: 18px; text-align: center; border-collapse: separate; border-spacing: 0px; margin: auto; background-color: var(--root-navbar-bg-color);">
                        <tr class="btl btr">
                            <td class="alertsTableTDF btl">1</td>
                            <td class="alertsTableTD btr">8:30-9:45</td>
                        </tr>
                        <tr>
                            <td class="alertsTableTDF">2</td>
                            <td class="alertsTableTD">9:55-11:10</td>
                        </tr>
                        <tr>
                            <td class="alertsTableTDF">БП</td>
                            <td class="alertsTableTD">11:10-11:40</td>
                        </tr>
                        <tr>
                            <td class="alertsTableTDF">3</td>
                            <td class="alertsTableTD">11:40-12:55</td>
                        </tr>
                        <tr>
                            <td class="alertsTableTDF">4</td>
                            <td class="alertsTableTD">13:05-14:20</td>
                        </tr>
                        <tr class="bbl bbr">
                            <td class="alertsTableTDF bbl">5</td>
                            <td class="alertsTableTD bbr">14:30-15:45</td>
                        </tr>
                    </table>
                    <div style="display: flex; justify-content: center;">
                        <button style="margin: 24px 0px; font-family: 'Montserrat' !important; cursor: pointer; border: none; border-radius: 16px; height: 42px; font-size: 16px; width: 100%;" onclick="location.assign('${link({type: 'HTML', file: '?timetable=week'})}')">Расписание на неделю</button>
                    </div>`
                } else {
                    critical('index.html', 'timetable page cant find current response')
                }

                plutonny.output('content', inj)
                if (REQUEST.timetable == 'week') { TIMETABLE.pair.weekChanger(CURRDATE.getDay()) }
            } else {
                try {
                    var headerUsername = '', headerGretings = '';
                    var month = ['января', 'февраля', 'марта', 'апреля', 'мая', 'июня', 'июля', 'августа', 'сентября', 'октября', 'ноября', 'декабря']
                         if (!deviceStorage.check('username'))                      { headerUsername += `, ${deviceStorage.get('username')}` }
                         if (CURRDATE.getHours() >= 5  && CURRDATE.getHours() < 12) { headerGretings += `Доброе утро` } 
                    else if (CURRDATE.getHours() >= 12 && CURRDATE.getHours() < 17) { headerGretings += `Добрый день` } 
                    else if (CURRDATE.getHours() >= 17 && CURRDATE.getHours() < 22) { headerGretings += `Добрый вечер`} 
                    else                                                            { headerGretings += `Доброй ночи` }
                    frames.header(`${headerGretings}${headerUsername}!`, [true, false], true);
                } catch (e) { plutonny.console.error('index.html', `home page (${e})`) }

                try {
                    var greetingFirst = '', greetingSecond = ''
                    if (CURRDATE.getDay() == 0) { greetingFirst = 'Сегодня пар нет' } 
                    else                        { greetingFirst = TIMETABLE.pair.get.current() }
                    greetingSecond = `${CURRDATE.getDate()} ${month[CURRDATE.getMonth()]}, ${CURRDATE.getDay() == 0 || (CURRDATE.getDay() == 6 && TIMETABLE.pair.get.current() == 'Пары закончились') ? `с пон-ка ${WEEK.name.alt.RU}` : WEEK.name.RU} неделя`
                    plutonny.output('greeting', `
                        <style>
                            .greeting { height: calc(15vh + 64px); padding-left: 24px; display: flex; flex-direction: column; flex-wrap: nowrap; justify-content: center; align-items: flex-start; }
                        </style>
                        <a style="font-size:28px; margin:0px; text-decoration: none;" href="${link({type: 'HTML', file: '?timetable=alerts'})}">${greetingFirst}</a>
                        <p style="font-size:16px; margin:0px;">${greetingSecond}</p>
                    `)
                } catch (e) { plutonny.console.error('index.html', `home page greeting (${e})`) }

                try {
                    var pairTitle = '', pairWeekNum = 0;
                         if (CURRDATE.getDay() == 0)                              { pairTitle = 'Пары завтра:'; pairWeekNum = 1 }
                    else if (CURRDATE.getDay() == 6) {
                          if (TIMETABLE.pair.get.current() == 'Пары закончились') { pairTitle = 'Пары в понедельник:'; pairWeekNum = 1 }
                        else                                                      { pairTitle = 'Пары сегодня:'; pairWeekNum = 6 }
                    } else {
                          if (TIMETABLE.pair.get.current() == 'Пары закончились') { pairTitle = 'Пары завтра:'; pairWeekNum = CURRDATE.getDay() + 1 }
                        else                                                      { pairTitle = 'Пары сегодня:'; pairWeekNum = CURRDATE.getDay() }
                    }
                } catch (e) { plutonny.console.error('index.html', `home page content (${e})`) }

                var pairDayChanges = `${NextDay.getDate() < 10 ? `0${NextDay.getDate()}` : `${NextDay.getDate()}`}.${(NextDay.getMonth() + 1) < 10 ? `0${NextDay.getMonth() + 1}` : `${NextDay.getMonth() + 1}`}`

                plutonny.output('content', `
                    <style>
                        .content { background-color: var(--secondary-bg-color); border-top-left-radius: 24px; border-top-right-radius: 24px; padding: 24px 24px 73px 24px; margin-top: 8px; min-height: calc(100vh - 100px); }
                    </style>
                    <p style="margin: 0px 0px 24px 0px; font-size: 22px;">${pairTitle}</p>

                    ${TIMETABLE.pair.get.HTML.day(TIMETABLE.pair.get.listOfDay([pairWeekNum, CURRDATE.getDay() == 0 ? WEEK.name.alt.EN : WEEK.name.EN]))}

                    <div style="display: flex; justify-content: center; flex-direction: column; padding: 24px 0px;">
                        <button style="margin: 0; font-family: 'Montserrat' !important; cursor: pointer; border: none; border-radius: 16px; height: 42px; font-size: 20px; width: 100%;" onclick="location.assign('https://docs.google.com/viewer?url=http://arcotel.ru/doc/stud/${pairDayChanges}.xlsx')">Изменения на ${pairDayChanges}</button>
                        <div style="height: 12px;"></div>
                        <button style="margin: 0; font-family: 'Montserrat' !important; cursor: pointer; border: none; border-radius: 16px; height: 42px; font-size: 20px; width: 100%;" onclick="location.assign('${link({type: 'HTML', file: '?timetable=week'})}')">Все пары</button>
                    </div>
                `)
            }
        </script>

        <script>
            deviceStorage.write('homeBuildPage', thisPageBuild)
        </script>
    </body>
</html>
