<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta                                       charset="UTF-8">
        <meta   http-equiv="Permissions-Policy"     content="interest-cohort=()">
        <meta   name="viewport"                     content="width=device-width, initial-scale=1.0">
        <meta   name="author"                       content="Plutonny">
        <meta   name="description"                  content="Настройки">
        <meta   name="theme-color" id="theme-color" content="#202020">

        <title  id="csc11-title-of-page"            >Настройки</title>

        <link   rel="preconnect"                    href="https://fonts.googleapis.com">
        <link   rel="preconnect"                    href="https://fonts.gstatic.com" crossorigin>
        <link   rel="stylesheet"                    href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap">
        <link   rel="stylesheet"                    href="https://fonts.googleapis.com/css2?family=Nunito:wght@600&display=swap">         <script type="text/javascript"              src="https://bebrarium.plutonny.ru/solar.js"></script>
        <script type="text/javascript"              src="https://bebrarium.plutonny.ru/luxon.js"></script>
        <script type="text/javascript"              src="//cdn.jsdelivr.net/npm/eruda"></script>
        
        <link   rel="icon"                          href="/assets/settings.png">
        <link   rel="manifest"                      href="/college-beta/manifest.json">
        <link   rel="preload prefetch stylesheet"   href="/assets/beta/main.css" as="style">

        <script> var thisPageBuild = 20; </script>
        
        <style  id="root-colors-theme">#thMoon, #thSun { display: none; }</style>
        
        <script type="text/javascript"              src="/assets/beta/plutonny.js"></script>
        <script type="text/javascript"              src="/assets/beta/preload.js"></script>
        <script type="text/javascript"              src="/assets/beta/frames.js"></script>
        <script type="text/javascript"              src="/assets/beta/main.js"></script>
    </head>
    <body>
        <div class="modal" id="modal"></div>
        <div class="header" id="header"><script>frames.header(`Настройки`, [true, true], false)</script></div>
        <div class="navbar" id="navbar"><script>frames.navbar('other')</script></div>
        <div class="settings" id="settings">
            <style>
                .settings { margin: 24px; padding-bottom: 80px; }
                p, a, b, h1, h2, h3, h4, h5, h6, button { font-family: 'Montserrat'; }
            </style>
            <h1 style="text-align: center; padding: 42px;">Ошибка!</h1>
            <p style="text-align: center;">Что случилось? Эта ошибка означает, что страница никак не смогла загрузиться.</p>
            <p style="padding-top: 36px;">Что делать? Можете написать разработчику.</p>
            <div style="display: flex; flex-direction: row; flex-wrap: nowrap; align-items: center; border-radius: 16px; padding: 8px; margin-top: 24px; background-color: #ff000050; fill: currentColor;">
                <p style="margin: 2px 4px; font-size: 15px;">Одна из вероятных проблем: не переустановленное приложение. Если Вы его переустановили и вновь увидели эту ошибку, то переустановите еще раз, но перед этим еще очистите кэш браузера.</p>
                <div style="width: 48px; padding: 0px 4px;"><svg style="color: #bd0000a8;" xmlns="http://www.w3.org/2000/svg" height="48" width="48"><path d="M24.2 34.4Q24.95 34.4 25.475 33.875Q26 33.35 26 32.55V23.75Q26 23.05 25.45 22.525Q24.9 22 24.2 22Q23.4 22 22.875 22.525Q22.35 23.05 22.35 23.8V32.6Q22.35 33.35 22.9 33.875Q23.45 34.4 24.2 34.4ZM24 17.9Q24.8 17.9 25.35 17.375Q25.9 16.85 25.9 16.05Q25.9 15.2 25.35 14.65Q24.8 14.1 24 14.1Q23.15 14.1 22.625 14.65Q22.1 15.2 22.1 16.05Q22.1 16.85 22.65 17.375Q23.2 17.9 24 17.9ZM24 44.8Q19.6 44.8 15.8 43.2Q12 41.6 9.2 38.8Q6.4 36 4.8 32.2Q3.2 28.4 3.2 24Q3.2 19.6 4.8 15.8Q6.4 12 9.2 9.2Q12 6.4 15.8 4.8Q19.6 3.2 24 3.2Q28.4 3.2 32.2 4.8Q36 6.4 38.8 9.2Q41.6 12 43.2 15.8Q44.8 19.6 44.8 24Q44.8 28.4 43.2 32.2Q41.6 36 38.8 38.8Q36 41.6 32.2 43.2Q28.4 44.8 24 44.8Z"/></svg></div>
            </div>
            <p>Для опытных пользователей: можно полностью сбросить настройки, это поможет, если проблема со стороны браузера (а проблема скорее всего именно со стороны браузера)</p>
            <div style="display: flex; align-items: center; justify-content: center; flex-wrap: wrap; margin-top: 12px; margin-bottom: 64px;">
                <script>
                    function DELETEALL() {
                        try {
                            localStorage.clear()
                            sessionStorage.clear()
                            caches.delete('csc11-byPlutonny')
                            caches.delete('plutonny-college')
                            document.getElementById('settings').innerHTML = `
                            <style>
                                .settings { margin: 24px; padding-bottom: 80px; }
                                p, a, b, h1, h2, h3, h4, h5, h6, button { font-family: 'Montserrat'; }
                            </style>
                            <h1 style="text-align: center; padding: 42px;">Успешно!</h1>
                            <p style="text-align: center;">Теперь можно перезагрузить страницу.</p>
                            `
                        } catch (e) {
                            document.getElementById('settings').innerHTML = `
                            <style>
                                .settings { margin: 24px; padding-bottom: 80px; }
                                p, a, b, h1, h2, h3, h4, h5, h6, button { font-family: 'Montserrat'; }
                            </style>
                            <h1 style="text-align: center; padding: 42px;">Не успешно!</h1>
                            <p style="text-align: center;">Прозошла ошибка при сбросе: ${e}</p>
                            `
                        }
                        
                    }
                </script>
                <button style="height: 48px; width: 256px; margin: 8px; border: none; border-radius: 100px; cursor: pointer;" onclick="DELETEALL()">Сбросить настройки</button>
            </div>
        </div>

        <script>
            /*
            var themeTimeF = '', themeTimeT = '';

            if (!deviceStorage.check('themeType3Time')) { 
                themeTimeF = deviceStorage.get('themeType3Time').charAt(0) + deviceStorage.get('themeType3Time').charAt(1) + deviceStorage.get('themeType3Time').charAt(2) + deviceStorage.get('themeType3Time').charAt(3) + deviceStorage.get('themeType3Time').charAt(4); 
                themeTimeT = deviceStorage.get('themeType3Time').charAt(5) + deviceStorage.get('themeType3Time').charAt(6) + deviceStorage.get('themeType3Time').charAt(7) + deviceStorage.get('themeType3Time').charAt(8) + deviceStorage.get('themeType3Time').charAt(9);
            }
            function tytheme3(setting) { 
                if (setting == 'get') { 
                      if (deviceStorage.check('themeType3Time')) { return 'не назначено' } 
                    else { return `${themeTimeF} - ${themeTimeT}` } 
                }
                else if (setting == 'set') {
                    modal('max', `
                    <div style="max-height: 95%; overflow-y: auto; margin-right: 5%; margin-left: 5%; padding-right: 12px; padding-left: 12px; background-color: var(--primary-bg-color); border: none; border-radius: 24px; box-shadow: 0px 0px 8px var(--navbar-box-color);">
                        <h1 style="font-family: 'Montserrat' !important; text-align: center; margin: 16px;">Время</h1>
                        <b style="font-family: 'Montserrat' !important; margin:16px;">Светлая тема:</b>
                        <div style="margin-left: 12px;"><label for="settingstimefrom" style="font-family: 'Montserrat' !important; margin:16px;">С:</label><input ${!deviceStorage.check('themeType3Time') ? `value="${themeTimeF}"` : ''} type="time" id="settingstimefrom" name="settingstimefrom" min="00:01" max="23:59" style="padding-left: 16px; padding-right: 16px; color: var(--root-text-color); border: none; border-radius: 18px; background-color: var(--secondary-bg-color); height: 22px; margin-top: 8px; margin-left: 4px;"></div>
                        <div style="margin-left: 12px;"><label for="settingstimeto" style="font-family: 'Montserrat' !important; margin:16px;">По:</label><input ${!deviceStorage.check('themeType3Time') ? `value="${themeTimeT}"` : ''} type="time" id="settingstimeto" name="settingstimeto" min="00:01" max="23:59" style="padding-left: 16px; padding-right: 16px; color: var(--root-text-color); border: none; border-radius: 18px; background-color: var(--secondary-bg-color); height: 22px; margin-top: 8px; margin-left: 4px;"></div>
                        <div style="display: flex; justify-content: center;">
                            <button style="font-family: 'Montserrat' !important; cursor: pointer; border: none; border-radius: 24px; height: 36px; font-size: 17px; width: 128px; margin: 16px;" onclick="document.getElementById('modal').innerHTML = ''; theme.load()">Отмена</button>
                            <button style="font-family: 'Montserrat' !important; cursor: pointer; border: none; border-radius: 24px; height: 36px; font-size: 17px; width: 148px; margin: 16px; background-color: #00ff0020;" onclick="deviceStorage.write('themeType3Time', settingstimefrom.value + settingstimeto.value); document.getElementById('modal').innerHTML = ''; theme.load()">Сохранить</button>
                        </div>
                    </div>
                    `)
                }
            }
            */

            plutonny.output(`settings`, `
            <style>
                .settings { background-color: var(--secondary-bg-color); border-top-left-radius: 24px; border-top-right-radius: 24px; padding: 24px 24px 73px 24px; min-height: calc(100vh - 100px); }
                input[type="time"]::-webkit-calendar-picker-indicator { display: none; }
            </style>

            <div style="display: flex; align-items: center; flex-direction: row; flex-wrap: nowrap;">
                <p style="margin-right: 14px;">Ник:</p>
                <input type="text" id="username" autocomplete="off" style="padding-left: 8px; color: var(--root-text-color); border: none; border-radius: 18px; background-color: var(--root-button-color); height: 22px; width: 156px;" ${ deviceStorage.check('username') ? '' : `value="${deviceStorage.get('username')}"` }>
                <p id="usernamesave" style="font-size: 14px; margin-left: 12px; opacity: 0.5; user-select: none;"></p>
            </div>

            <div style="display: flex; flex-direction: column; align-items: flex-start;">
                <p style="margin-bottom: 8px;">Работа смены темы:</p>
                <div style="display: flex; flex-direction: column; flex-wrap: nowrap; align-items: flex-start;">
                    <div style="display: flex; align-items: center;">
                        <input type="radio" id="tytheme1" name="tytheme" ${deviceStorage.get('themeType') == 1 ? 'checked' : ''} onchange="settingsChangeType(1)" style="margin: 0px 12px 0px 6px;" value="theme">
                        <label for="tytheme1">по нажатию кнопки</label>
                    </div>
                    <div style="margin: 6px 0px 6px 16px; display: flex; align-items: center;">
                        <input type="checkbox" id="entheme" name="entheme" ${deviceStorage.get('themeEnableThemeButton') == 'true' ? 'checked' : ''} ${deviceStorage.get('themeType') == 2 || deviceStorage.get('themeType') == 3 ? 'disabled="disabled"' : ''} onchange="settingsEnableThemeButton()" style="margin: 0px 12px 0px 6px;" value="theme">
                        <label for="entheme">включить кнопку смены темы</label>
                    </div>
                    <div style="display: flex; align-items: center;">
                        <input type="radio" id="tytheme2" name="tytheme" ${deviceStorage.get('themeType') == 2 ? 'checked' : ''} onchange="settingsChangeType(2)" style="margin: 0px 12px 0px 6px;" value="theme">
                        <label for="tytheme2">по времени рассвета/заката</label>
                    </div>`+/*`
                    <!--
                    <div style="margin-top: 3px;">
                        <input type="radio" id="tytheme3" name="tytheme" ${deviceStorage.get('themeType') == 3 ? 'checked' : ''} onchange="settingsChangeType(3)" onclick="tytheme3('set')" style="margin-right: 12px;" value="theme">
                        <label for="tytheme3">по времени: ${tytheme3('get')}</label>
                    </div>
                    -->`+*/`
                </div>
                <p style="margin-bottom: 8px;">Градиент фона страницы:</p>
                <div style="display: flex; flex-direction: column; flex-wrap: nowrap; align-items: flex-start;">
                    <div style="display: flex; align-items: center;">
                        <input type="radio" id="acbgcolor1" name="acbgcolor" ${deviceStorage.get('acbgcolor') == 'default' ? 'checked' : ''} onchange="deviceStorage.write('acbgcolor', 'default')" style="margin: 0px 12px 0px 6px;">
                        <label for="acbgcolor1">стандартный</label>
                    </div>
                    <div style="height: 6px;"></div>
                    <div style="display: flex; align-items: center;">
                        <input type="radio" id="acbgcolor2" name="acbgcolor" ${deviceStorage.get('acbgcolor') == 'weekcolor' ? 'checked' : ''} onchange="deviceStorage.write('acbgcolor', 'weekcolor')" style="margin: 0px 12px 0px 6px;">
                        <label for="acbgcolor2">цвет недели</label>
                    </div>
                </div>
                <p style="margin-bottom: 8px;">Вид панели навигации:</p>
                <div style="display: flex; flex-direction: column; flex-wrap: nowrap; align-items: flex-start;">
                    <div style="display: flex; align-items: center;">
                        <input type="radio" id="worknavbar1" name="worknavbar" ${deviceStorage.get('worknavbar') == 'default' ? 'checked' : ''} onchange="deviceStorage.write('worknavbar', 'default'); frames.navbar('other')" style="margin: 0px 12px 0px 6px;">
                        <label for="worknavbar1">стандартный</label>
                    </div>
                    <div style="height: 6px;"></div>
                    <div style="display: flex; align-items: center;">
                        <input type="radio" id="worknavbar2" name="worknavbar" ${deviceStorage.get('worknavbar') == 'float' ? 'checked' : ''} onchange="deviceStorage.write('worknavbar', 'float'); frames.navbar('other')" style="margin: 0px 12px 0px 6px;">
                        <label for="worknavbar2">плавающий</label>
                    </div>
                </div>
                <p style="margin-bottom: 8px;">Другое:</p>
                <div style="display: flex; align-items: center;">
                    <input type="checkbox" id="PATRIOTMODE" name="PATRIOTMODE" ${deviceStorage.get('PATRIOTMODE') == 'true' ? 'checked' : ''} onchange="settingsEnablePATRIOTMODE()" style="margin: 0px 12px 0px 6px;" value="theme">
                    <label for="PATRIOTMODE">включить замену букв "3" и "B"</label>
                </div>
            </div>
            <div style="display: flex; align-items: center; justify-content: center; flex-wrap: wrap; margin-top: 12px; margin-bottom: 64px;">
                <button style="height: 48px; width: 256px; margin: 8px; border: none; border-radius: 100px; cursor: pointer;" onclick="DELETEALL()">Сбросить все данные</button>
            </div>
            `)

            var themeCheckboxBox = document.getElementById('entheme');
            function settingsEnableThemeButton() { deviceStorage.write('themeEnableThemeButton', deviceStorage.get('themeEnableThemeButton') == 'true' ? false : true); frames.header('Настройки', [deviceStorage.get('themeEnableThemeButton') == 'true', true], false)}
            function settingsEnablePATRIOTMODE() { deviceStorage.write('PATRIOTMODE', deviceStorage.get('PATRIOTMODE') == 'true' ? false : true) }

            /* 1 - theme button (or none); 2 - sunrise/sunset; 3 - custom time */
            function settingsChangeType(type) { 
                deviceStorage.write('themeType', type)
                if (type == 1) { 
                    deviceStorage.write('themeEnableThemeButton', `true`); themeCheckboxBox.setAttribute('checked', 'checked')
                    frames.header(`Настройки`, [true, true], false)
                }
                if (type == 2 || type == 3) {
                    deviceStorage.write('themeEnableThemeButton', `false`); themeCheckboxBox.removeAttribute('checked')
                    frames.header(`Настройки`, [false, true], false)
                } 
                theme.load()
            }

            username.oninput = async function() { deviceStorage.write('username', username.value); usernamesave.innerHTML = 'сохранено'; await plutonny.sleep(2500); usernamesave.innerHTML = '' }

            function DELETEALL() {
                try {
                    localStorage.clear()
                    sessionStorage.clear()
                    caches.delete('csc11-byPlutonny')
                    caches.delete('plutonny-college')
                    document.body.innerHTML = `
                    <style>
                        body { margin: 24px; padding-bottom: 80px; }
                        p, a, b, h1, h2, h3, h4, h5, h6, button { font-family: 'Montserrat'; }
                    </style>
                    <h1 style="text-align: center; padding: 42px;">Успешно!</h1>
                    <p style="text-align: center;">Теперь можно перезагрузить страницу.</p>
                    `
                } catch (e) {
                    document.body.innerHTML = `
                    <style>
                        body { margin: 24px; padding-bottom: 80px; }
                        p, a, b, h1, h2, h3, h4, h5, h6, button { font-family: 'Montserrat'; }
                    </style>
                    <h1 style="text-align: center; padding: 42px;">Не успешно!</h1>
                    <p style="text-align: center;">Прозошла ошибка при сбросе: ${e}</p>
                    `
                }
                
            }
        </script>

        <script>
            deviceStorage.write('settingsBuildPage', thisPageBuild)
        </script>
    </body>
</html>