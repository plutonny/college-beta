<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta                                       charset="UTF-8">
        <meta   http-equiv="Permissions-Policy"     content="interest-cohort=()">
        <meta   name="viewport"                     content="width=device-width, initial-scale=1.0">
        <meta   name="author"                       content="Plutonny">
        <meta   name="description"                  content="Настройки">
        <meta   name="theme-color" id="theme-color" content="#202020">

        <title  id="csc11-title-of-page"            >Настройки</title>

        <link   rel="preload prefetch" as="font"    href="/assets/fonts/n2.woff2" type="font/woff2" crossorigin="anonymous">
        <link   rel="preload prefetch" as="font"    href="/assets/fonts/m2.woff2" type="font/woff2" crossorigin="anonymous">
        <script type="text/javascript"              src="/assets/solar.js"></script>
        <script type="text/javascript"              src="/assets/luxon.js"></script>
        <script type="text/javascript"              src="//cdn.jsdelivr.net/npm/eruda"></script>
        
        <link   rel="icon"                          href="/assets/settings.png">
        <link   rel="manifest"                      href="/college-beta/manifest.json">
        <link   rel="preload prefetch stylesheet"   href="/assets/beta/main.css" as="style">

        <script> var thisPageBuild = 19; </script>
        
        <style  id="root-colors-theme"></style>
        
        <script type="text/javascript"              src="/assets/beta/preload.js"></script>
        <script type="text/javascript"              src="/assets/beta/frames.js"></script>
        <script type="text/javascript"              src="/assets/beta/main.js"></script>

        <noscript>
            <style>
                html, body { background-color: #202020; }
                p, a       { color: #f4f4f4; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 28px; text-align: center; }
                div        { margin-top: 64px; }
            </style>
            <div>
                <p>Если ты читаешь этот текст, то у тебя отключен или не поддерживается браузером JavaScript</p>
                <p>Функционал данного сайта недоступен, можете перейти на <a href="/college/simpleoutjs.html">упрощенную страницу</a></p>
            </div>
        </noscript>
    </head>
    <body>
        <div class="modal" id="modal"></div>
        <div class="header" id="header"><script>frames.header(`Настройки`, [true, true], false)</script></div>
        <div class="navbar" id="navbar"><script>frames.navbar('other')</script></div>
        <div class="settings" id="settings"></div>

        <script>
            /*
            var themeTimeF = '', themeTimeT = '';

            if (!deviceStorage.check('themeType3Time')) { 
                themeTimeF = deviceStorage.get('themeType3Time').charAt(0) + deviceStorage.get('themeType3Time').charAt(1) + deviceStorage.get('themeType3Time').charAt(2) + deviceStorage.get('themeType3Time').charAt(3) + deviceStorage.get('themeType3Time').charAt(4); 
                themeTimeT = deviceStorage.get('themeType3Time').charAt(5) + deviceStorage.get('themeType3Time').charAt(6) + deviceStorage.get('themeType3Time').charAt(7) + deviceStorage.get('themeType3Time').charAt(8) + deviceStorage.get('themeType3Time').charAt(9);
            }
            function tytheme3(setting) { 
                if (setting == 'get') { 
                      if (deviceStorage.check('themeType3Time')) { return 'не назначено' } 
                    else { return `${themeTimeF} - ${themeTimeT}` } 
                }
                else if (setting == 'set') {
                    modal('max', `
                    <div style="max-height: 95%; overflow-y: auto; margin-right: 5%; margin-left: 5%; padding-right: 12px; padding-left: 12px; background-color: var(--primary-bg-color); border: none; border-radius: 24px; box-shadow: 0px 0px 8px var(--navbar-box-color);">
                        <h1 style="font-family: 'Montserrat' !important; text-align: center; margin: 16px;">Время</h1>
                        <b style="font-family: 'Montserrat' !important; margin:16px;">Светлая тема:</b>
                        <div style="margin-left: 12px;"><label for="settingstimefrom" style="font-family: 'Montserrat' !important; margin:16px;">С:</label><input ${!deviceStorage.check('themeType3Time') ? `value="${themeTimeF}"` : ''} type="time" id="settingstimefrom" name="settingstimefrom" min="00:01" max="23:59" style="padding-left: 16px; padding-right: 16px; color: var(--root-text-color); border: none; border-radius: 18px; background-color: var(--secondary-bg-color); height: 22px; margin-top: 8px; margin-left: 4px;"></div>
                        <div style="margin-left: 12px;"><label for="settingstimeto" style="font-family: 'Montserrat' !important; margin:16px;">По:</label><input ${!deviceStorage.check('themeType3Time') ? `value="${themeTimeT}"` : ''} type="time" id="settingstimeto" name="settingstimeto" min="00:01" max="23:59" style="padding-left: 16px; padding-right: 16px; color: var(--root-text-color); border: none; border-radius: 18px; background-color: var(--secondary-bg-color); height: 22px; margin-top: 8px; margin-left: 4px;"></div>
                        <div style="display: flex; justify-content: center;">
                            <button style="font-family: 'Montserrat' !important; cursor: pointer; border: none; border-radius: 24px; height: 36px; font-size: 17px; width: 128px; margin: 16px;" onclick="document.getElementById('modal').innerHTML = ''; theme.load()">Отмена</button>
                            <button style="font-family: 'Montserrat' !important; cursor: pointer; border: none; border-radius: 24px; height: 36px; font-size: 17px; width: 148px; margin: 16px; background-color: #00ff0020;" onclick="deviceStorage.write('themeType3Time', settingstimefrom.value + settingstimeto.value); document.getElementById('modal').innerHTML = ''; theme.load()">Сохранить</button>
                        </div>
                    </div>
                    `)
                }
            }
            */

            page.output(`settings`, `
            <style>
                .settings { background-color: var(--secondary-bg-color); border-top-left-radius: 24px; border-top-right-radius: 24px; padding: 24px 24px 73px 24px; min-height: calc(100vh - 100px); }
                input[type="time"]::-webkit-calendar-picker-indicator { display: none; }
            </style>

            <div style="display: flex; align-items: center; flex-direction: row; flex-wrap: nowrap;">
                <p style="margin-right: 14px;">Ник:</p>
                <input type="text" id="username" autocomplete="off" style="padding-left: 8px; color: var(--root-text-color); border: none; border-radius: 18px; background-color: var(--root-button-color); height: 22px; width: 156px;" ${ deviceStorage.check('username') ? '' : `value="${deviceStorage.get('username')}"` }>
                <p id="usernamesave" style="font-size: 14px; margin-left: 12px; opacity: 0.5; user-select: none;"></p>
            </div>

            <div style="display: flex; flex-direction: column; align-items: flex-start;">
                <p>Работа смены темы:</p>
                <div style="display: flex; flex-direction: column; flex-wrap: nowrap; align-items: flex-start;">
                    <div style="display: flex; align-items: center;">
                        <input type="radio" id="tytheme1" name="tytheme" ${deviceStorage.get('themeType') == 1 ? 'checked' : ''} onchange="settingsChangeType(1)" style="margin: 0px 12px 0px 6px;" value="theme">
                        <label for="tytheme1">по нажатию кнопки</label>
                    </div>
                    <div style="margin: 6px 0px 6px 16px; display: flex; align-items: center;">
                        <input type="checkbox" id="entheme" name="entheme" ${deviceStorage.get('themeEnableThemeButton') == 'true' ? 'checked' : ''} ${deviceStorage.get('themeType') == 2 || deviceStorage.get('themeType') == 3 ? 'disabled="disabled"' : ''} onchange="settingsEnableThemeButton()" style="margin: 0px 12px 0px 6px;" value="theme">
                        <label for="entheme">включить кнопку смены темы</label>
                    </div>
                    <div style="display: flex; align-items: center;">
                        <input type="radio" id="tytheme2" name="tytheme" ${deviceStorage.get('themeType') == 2 ? 'checked' : ''} onchange="settingsChangeType(2)" style="margin: 0px 12px 0px 6px;" value="theme">
                        <label for="tytheme2">по времени рассвета/заката</label>
                    </div>`+/*`
                    <!--
                    <div style="margin-top: 3px;">
                        <input type="radio" id="tytheme3" name="tytheme" ${deviceStorage.get('themeType') == 3 ? 'checked' : ''} onchange="settingsChangeType(3)" onclick="tytheme3('set')" style="margin-right: 12px;" value="theme">
                        <label for="tytheme3">по времени: ${tytheme3('get')}</label>
                    </div>
                    -->`+*/`
                </div>
                <p>Градиент фона страницы:</p>
                <div style="display: flex; flex-direction: column; flex-wrap: nowrap; align-items: flex-start;">
                    <div style="display: flex; align-items: center;">
                        <input type="radio" id="acbgcolor1" name="acbgcolor" ${deviceStorage.get('acbgcolor') == 'default' ? 'checked' : ''} onchange="deviceStorage.write('acbgcolor', 'default')" style="margin: 0px 12px 0px 6px;">
                        <label for="acbgcolor1">стандартный</label>
                    </div>
                    <div style="height: 6px;"></div>
                    <div style="display: flex; align-items: center;">
                        <input type="radio" id="acbgcolor2" name="acbgcolor" ${deviceStorage.get('acbgcolor') == 'weekcolor' ? 'checked' : ''} onchange="deviceStorage.write('acbgcolor', 'weekcolor')" style="margin: 0px 12px 0px 6px;">
                        <label for="acbgcolor2">цвет недели</label>
                    </div>
                </div>
                <p>Вид панели навигации:</p>
                <div style="display: flex; flex-direction: column; flex-wrap: nowrap; align-items: flex-start;">
                    <div style="display: flex; align-items: center;">
                        <input type="radio" id="worknavbar1" name="worknavbar" ${deviceStorage.get('worknavbar') == 'default' ? 'checked' : ''} onchange="deviceStorage.write('worknavbar', 'default'); frames.navbar('other')" style="margin: 0px 12px 0px 6px;">
                        <label for="worknavbar1">стандартный</label>
                    </div>
                    <div style="height: 6px;"></div>
                    <div style="display: flex; align-items: center;">
                        <input type="radio" id="worknavbar2" name="worknavbar" ${deviceStorage.get('worknavbar') == 'float' ? 'checked' : ''} onchange="deviceStorage.write('worknavbar', 'float'); frames.navbar('other')" style="margin: 0px 12px 0px 6px;">
                        <label for="worknavbar2">плавающий</label>
                    </div>
                </div>
            </div>
            `)

            var themeCheckboxBox = document.getElementById('entheme');
            function settingsEnableThemeButton() { deviceStorage.write('themeEnableThemeButton', deviceStorage.get('themeEnableThemeButton') == 'true' ? false : true); frames.header('Настройки', [deviceStorage.get('themeEnableThemeButton') == 'true', true], false)}
            
            /* 1 - theme button (or none); 2 - sunrise/sunset; 3 - custom time */
            function settingsChangeType(type) { 
                deviceStorage.write('themeType', type)
                if (type == 1) { 
                    deviceStorage.write('themeEnableThemeButton', `true`); themeCheckboxBox.setAttribute('checked', 'checked')
                    frames.header(`Настройки`, [true, true], false)
                }
                if (type == 2 || type == 3) {
                    deviceStorage.write('themeEnableThemeButton', `false`); themeCheckboxBox.removeAttribute('checked')
                    frames.header(`Настройки`, [false, true], false)
                } 
                theme.load()
            }

            username.oninput = async function() { deviceStorage.write('username', username.value); usernamesave.innerHTML = 'сохранено'; await page.sleep(2500); usernamesave.innerHTML = '' }
        </script>

        <script>
            deviceStorage.write('settingsBuildPage', thisPageBuild)
        </script>
    </body>
</html>