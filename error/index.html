<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta                                       charset="UTF-8">
        <meta   http-equiv="Permissions-Policy"     content="interest-cohort=()">
        <meta   name="viewport"                     content="width=device-width, initial-scale=1.0">
        <meta   name="author"                       content="Plutonny">
        <meta   name="description"                  content="Ошибка">
        <meta   name="theme-color" id="theme-color" content="#202020">

        <title  id="csc11-title-of-page"            >Ошибка :(</title>

        <script type="text/javascript"              src="//cdn.jsdelivr.net/npm/eruda"></script>

        <link   rel="icon"                          href="/assets/settings.png">
        <script type="text/javascript"              src="/assets/luxon.js"></script>
        <link   rel="manifest"                      href="/college-beta/manifest.json">
        <link   rel="preload prefetch stylesheet"   href="/assets/beta/main.css" as="style">
        <script type="text/javascript"              src="/assets/beta/preload.js"></script>

        <noscript>
            <style>
                html, body { background-color: #202020; }
                p, a       { color: #f4f4f4; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 28px; text-align: center; }
                div        { margin-top: 64px; }
            </style>
            <div>
                <p>Если ты читаешь этот текст, то у тебя отключен или не поддерживается браузером JavaScript</p>
                <p>Функционал данного сайта недоступен, можете перейти на <a href="/college/simpleoutjs.html">упрощенную страницу</a></p>
            </div>
        </noscript>
    </head>
    <body>
        <div class="modal" id="modal"></div>

        <div id="error" style="margin-left: 16px; margin-right: 16px;">
            <h2 style="text-align: center;">Если вы читаете этот текст, это означает, что даже страница ошибки не может нормально отображаться. В этом случае советую написать разработчику, он поможет решить данную проблему.</h2>
            <script>
                /**
                 *  Output modal with additional info in error page
                 */
                function allInfoErrorModal(selfError) {
                    var listLocalStrage =  '';
                    for (var i = 0; i < localStorage.length; i++) { listLocalStrage += `<p style="font-family: 'Montserrat' !important; background-color: #00000020; border-radius: 12px; padding: 4px 8px; margin: 4px; font-size: 14px;">${localStorage.key(i)} - ${localStorage.getItem(localStorage.key(i))}</p>`  }
                    modal(`
                    <div style="max-height: 95%; overflow-y: auto; margin-right: 5%; margin-left: 5%; padding-right: 12px; padding-left: 12px; background-color: var(--primary-bg-color); border: none; border-radius: 24px; box-shadow: 0px 0px 8px var(--navbar-box-color);">

                        <h2 style="font-family: 'Montserrat' !important; text-align: center; margin: 16px 6px; background-color: #ff000070; border-radius: 12px; padding: 6px;">${selfError}</h2>

                        <p style="font-family: 'Montserrat' !important; margin:16px; text-align: center; font-size: 20px;">Ключи localStorage:</p>
                        <div style="display: flex; flex-direction: row; flex-wrap: wrap; justify-content: center;">${listLocalStrage}</div>

                        <div style="display:flex;justify-content:center;">
                            <button style="font-family: 'Montserrat' !important; cursor: pointer; border: none; border-radius: 24px; height: 36px; font-size: 17px; width: 256px; margin: 4px 16px 16px 16px;" onclick="document.getElementById('modal').innerHTML = ''">Закрыть</button>
                        </div>
                    </div>
                `)
                }

                if (REQUEST.err == 'gtable') {
                    page.output('error', `
                        <style>
                            :root {
                                --root-text-color      :#000000;
                                --active-text-color    :#202020;
                                --primary-bg-color     :#f4f4f4;
                                --root-button-color    :#dddddd;
                                --hover-button-color   :#d2d2d2;
                                --active-button-color  :#c0c0c0;
                                --week-color           :#55555555 !important;
                            }
                        </style>
                        <h1 style="margin-bottom: 76px; margin-top: 76px; text-align: center;">404</h1>
                        <h3 style="text-align: center;">Что случилось?<br>Кажется, вы попытались открыть страницу с таблицей, но что-то пошло не так...</h3>
                        <div style="display: flex; align-items: center; justify-content: center; flex-wrap: wrap; margin-top: 48px;">
                            <button style="height: 36px; width: 196px; margin: 8px; border: none; border-radius: 100px; cursor: pointer;" onclick="history.back(); sessionStorage.removeItem('errorPageLog'); sessionStorage.removeItem('errorPageError')">Вернуться назад</button>
                        </div>
                        <h3 style="text-align: center; margin-top: 48px;">Если вы попали сюда случайно, напишите <a href="https://vk.me/pltny" target="_blank">разработчику</a>, чтобы разобраться в этой проблеме. Советую нажать а кнопку ниже и скинуть <a href="https://vk.me/pltny" target="_blank">ему</a> скрин, что выдала эта шайтан машина</h3>
                        <div style="display: flex; align-items: center; justify-content: center; flex-wrap: wrap; margin-top: 26px; margin-bottom: 64px;">
                            <button style="height: 48px; width: 256px; margin: 8px; border: none; border-radius: 100px; cursor: pointer;" onclick="allInfoErrorModal(sessionStorage.getItem('errorPageError'), sessionStorage.getItem('errorPageLog'))">Дополнительная информация</button>
                        </div>
                    `)
                } else {
                    page.output('error', `
                        <h1 style="margin-bottom: 76px; margin-top: 76px; text-align: center;">Произошла критическая ошибка!</h1>
                        <h3 style="text-align: center;">Что случилось?<br>Сайт говорит нам неведомые "${sessionStorage.getItem('errorPageError')}"</h3>
                        <div style="display: flex; align-items: center; justify-content: center; flex-wrap: wrap; margin-top: 48px;">
                            <button style="height: 36px; width: 196px; margin: 8px; border: none; border-radius: 100px; cursor: pointer;" onclick="history.back(); sessionStorage.removeItem('errorPageError')">Вернуться назад</button>
                            <!--<button style="height: 36px; width: 148px; margin: 8px; border: none; border-radius: 100px; cursor: pointer;" onclick="location.assign('/college${betaRepos}/support/?q=error')">Поддержка</button>-->
                        </div>
                        <h3 style="text-align: center; margin-top: 48px;">Если хотите помочь <a href="https://vk.me/pltny" target="_blank">разработчику</a> разобраться в этой проблеме быстрее,<br>нажмите на кнопку ниже и отправьте <a href="https://vk.me/pltny" target="_blank">ему</a> скрин, что выдала эта шайтан машина</h3>
                        <div style="display: flex; align-items: center; justify-content: center; flex-wrap: wrap; margin-top: 26px; margin-bottom: 64px;">
                            <button style="height: 48px; width: 256px; margin: 8px; border: none; border-radius: 100px; cursor: pointer;" onclick="allInfoErrorModal(sessionStorage.getItem('errorPageError'))">Дополнительная информация</button>
                        </div>
                        <h3 style="text-align: center; margin-top: 48px;">Так же вы можете воспользоваться упрощенной страницей, на которой возникшей ошибки быть не должно</h3>
                        <div style="display: flex; align-items: center; justify-content: center; flex-wrap: wrap; margin-top: 26px; margin-bottom: 64px;">
                            <button style="height: 48px; width: 256px; margin: 8px; border: none; border-radius: 100px; cursor: pointer;" onclick="location.assign('/college${betaRepos}/simple/')">Перейти</button>
                        </div>
                    `)
                }
            </script>
        </div>
    </body>
</html>